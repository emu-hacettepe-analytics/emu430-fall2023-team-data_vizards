---
title: "Analysis"
---
```{r}
library(tidyverse)
library(readxl)


population <- read_excel("C:\\Users\\zeyne\\Desktop\\DataVizards_FinalDataFrame.xlsx")
names(population) <- c('IDD','city','regionid','regions','totalpop','male','female','age04','age59','age1014','age1519','age2024','age2529','age3034','age3539','age4044','otherage','unknowns','doctorate','primaryedu','elementaryedu','highschool','literatebutnoschool','notliterate','middleschool','master','university','fertilityrate','electricity','numberofattempts','housingsalesnumbers')

region26 <- read_excel("C:\\Users\\zeyne\\Desktop\\DataVizards_FinalDataFrame.xlsx", sheet = "26 Bölge")
names(region26) <- c('region','region2id','workforce15plus','workforce1564','usableincome')

migration <- read_excel("C:\\Users\\zeyne\\Desktop\\DataVizards_FinalDataFrame.xlsx", sheet = "Göç Bilgileri")
names(migration) <- c('IDD','male2','female2','turnbackfamily','unknowns2','betterlifecond','others','education','retirement','buyhome','familymig','finjob','maritalstatuschange','health','appointment','age04_2','age59_2','age1014_2','age1519_2','age2024_2','age2529_2','age3034_2','age3539_2','age4044_2','university2','highschool2','middleschool2', 'elementaryschool2')


df <- data.frame(
  migrationcause <- rep(c("Education", "Health", "Turnbackfamily", "Betterlifecond", 
                         "Retirement", "Buyhome", "Familymig", "Finjob", 
                         "Maritalstatuschange", "Appointment"),each = nrow(migration)),
  value <- c(migration$education, migration$health, migration$turnbackfamily, 
            migration$betterlifecond, migration$retirement, migration$buyhome, 
            migration$familymig, migration$finjob, migration$maritalstatuschange, 
            migration$appointment)
)

# Plot the boxplot
df %>% ggplot(aes(x = migrationcause, y = value, fill = migrationcause)) +
  geom_boxplot() + 
  labs(title = "Migration Causes",
       x = "Migration Causes",
       y = "Values") +
  theme(axis.text.x = element_text(angle= 90, hjust = 1)) + xlab("") +
  scale_y_continuous(trans = "log2") 
```